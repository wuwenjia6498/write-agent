# 📝 产品需求文档：老约翰自动化写作AGENT (v1.2)

## 1. 项目概述
* **项目名称**：老约翰自动化写作AGENT
* **产品定位**：一个基于 AI 驱动的独立 Web 写作平台，专门服务于“老约翰儿童阅读”品牌的多元化内容创作。
* **核心目标**：通过结构化的 **9 步 SOP**、**两层判断机制**和**公司级共享素材库**，实现 15 年品牌调性的工业化产出。
* **核心受众**：公司运营团队、策划人员及阅读推广老师。

---

## 2. 核心架构：两层判断机制
系统在接收任务时，会自动执行以下判断逻辑以加载正确的上下文：

### 2.1 第一层：工作区路由 (Workspace Routing)
* **逻辑**：识别任务所属的大类（如：公众号创作、视频脚本、营销文案等）。
* **说明**：当前阶段重心锁定在“公众号创作”工作区。

### 2.2 第二层：内容频道路由 (Channel Routing)
系统预设三个垂直频道，AI 将根据用户选择自动切换专业人格与素材范围：

* **频道 A：深度阅读 (小学段)**
    * **核心业务**：经典文学拆解、整本书阅读策略、思考力引导。
    * **创作风格**：专业、有文学厚度、逻辑严密、拒绝低幼化表达。
* **频道 B：绘本阅读 (幼儿段)**
    * **核心业务**：高品质绘本推荐、亲子共读习惯、审美启蒙。
    * **创作风格**：温润、活泼、强调画面感与亲子互动感。
* **频道 C：育儿方向 (家长随笔)**
    * **核心业务**：缓解家长焦虑、分享 15 年行业观察、探讨教育真理。
    * **创作风格**：睿智老友式对谈、平等、有温度、富有同理心。

---

## 3. 核心功能：9 步完整 SOP 工作流
系统将 `CLAUDE.md` 的 9 步流程转化为 Web 页面的动态导航，每一步均设有状态管理：

| 步骤 | 功能名称 | 业务逻辑与约束 |
| :--- | :--- | :--- |
| **S1** | **需求保存** | 录入基础 Brief，自动生成标准需求文档存入 `_briefs` 目录。 |
| **S2** | **智能调研** | 调用搜索 API 进行背景调研，确保信息时效性，结果存入 `_knowledge_base`。 |
| **S3** | **选题决策** | **强制卡点**：输出 3-4 个选题方向，用户确认后方可解锁后续流程。 |
| **S4** | **协作清单** | 明确 AI 任务与用户需提供的真实数据碎片，生成 `协作清单`。 |
| **S5** | **素材注入** | 自动从 `_个人素材库` 检索“手感”、“揉馒头”等品牌特色隐喻。 |
| **S6** | **挂起等待** | 确认所有关键真实数据已就绪，**绝不编造虚假情节**。 |
| **S7** | **初稿创作** | 开启 **Think Aloud**，融入频道特色语调流式生成文章。 |
| **S8** | **三遍审校** | 依次执行内容、风格、细节审校，**强制过滤屏蔽词库**。 |
| **S9** | **配图方案** | 结合内容提供 5-8 张配图建议及对应的 AI 绘图提示词。 |

---

## 4. 品牌资产管理与频道扩展

### 4.1 资产编辑器
* **品牌档案管理**：在线维护 `个人简介.md`、`写作价值观.md`。
* **全局屏蔽词库**：实时更新 AI 腔黑名单，确保输出“去工业化”。
* **素材瀑布流**：同事可随时上传课堂金句、生活感悟，系统自动进行向量化存储 (RAG)。

### 4.2 频道管理 (灵活扩展)
* **Web 界面新增**：支持在后台新增内容频道。配置项包括：名称、读者画像、写作指令 (System Prompt)、专属样文。
* **代码级扩展**：涉及流程节点变化或新工具（如绘本数据库 API）接入时，由 Cursor 调整后端逻辑。

---

## 5. 技术架构设计



* **前端 (Frontend)**：**Next.js 15 (App Router)**。负责步骤引导、实时预览及资产管理。
* **后端 (Backend)**：**Python (FastAPI) + LangGraph**。
    * 使用 LangGraph 管理复杂的 9 步循环逻辑及人工决策点。
    * 通过 RAG 技术实现品牌资产的语义检索。
* **数据库**：**Supabase (PostgreSQL + pgvector)**。
* **模型选型**：**Claude 3.5 Sonnet** (核心写作) + **Search API** (辅助调研)。

---

## 6. 开发路线图 (Roadmap)

1.  **第一阶段 (P0)**：搭建 Next.js 基础框架，实现单频道下的 9 步 SOP 全自动长文写作流程。
2.  **第二阶段 (P1)**：上线“三频道”切换逻辑，实现不同频道加载不同样文与 Prompt 组合。
3.  **第三阶段 (P2)**：集成向量数据库，实现“个人素材库”在写作过程中的自动精准调用。

---